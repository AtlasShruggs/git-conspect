# Контроль версий

Для сохранения промежуточного прогресса при создании различных проектов, а также совместной работы с кодом есть много разных программ, самая популярная - __git__

$~$

## __Git__

__git__ создает репозиторий (как обычная папка, но с общим доступом через определенный адрес), в котором можно сохранять рабочие файлы, создавать удобную историю версий, откатываться к предыдущим вариантам проекта, если текущий "вдруг" нас больше не устраивает.

$~$

## **Настройка окружения** 

Чтобы начать работать с **git** - нужно скачать и установить приложение с сайта.

В дальнейшем для работы с программой можно пользоваться терминалом ОС / встроенным терминалом Git, но самым удобным (для меня) на данный момент способом работы является _Visual Studio Code_.

В VSC можно параллельно работать как с кодом, так и с терминалом для вызова команд __git__

$~$

## **Команды git**

$~$

### __git init__ - начало работы

Для того чтобы создать репозиторий в какой-то папке, необходимо с помощью терминала / VSC в эту папку перейти и выполнить команду 

    git init

Таким образом папка превратится в репозиторий; наглядно это можно увидеть, если включено отображение скрытых файлов и папок - в рабочей папке появится скрытая папка с раширением __.git__

$~$

### **git add <'name'>** - выбор файла, над которым производятся git-манипуляции

Для того, чтобы __git__ начал отслеживать статус и изменения файлов, эти файлы надо в __git__ добавить (несмотря на то, что физически на компьютере они уже в папке с репозиторием)

Для этого мы вводим команду 

    git add filename

$~$

__Важно__:

- не всегда нужно полностью вводить имя файла, достаточно ввести первые несколько букв и нажать _Tab_, возможно, несколько раз.

- мы будем использовать _git add_ всякий раз, как будем обращаться к какому-то определенному файлу в репозитории перед коммитом, чтобы обозначить, какие именно изменения коммитить

- чтобы любые изменения зафиксировались / отобразились / сохранились в __git__, нужно сохранять файл локально на компьютере

$~$

### **git status** - текущие изменения

    git status 

Эту команду мы вызываем для того, чтобы посмотреть, в каких файлах произошли изменения с последнего коммита

$~$

### __git diff__

Если же мы хотим посмотреть, какие именно изменения произошли в наших файлах - мы вызовем команду 

    git diff

Она покажет строки, которые мы убрали, а также строки, которые были добавлены

$~$

Также _git diff_ позволяет отследить изменения между любыми выбранными пользователем коммитами. Для этого хеши этих коммитов нужно передать через пробел в метод:

    git diff 0004 0658

### __git commit -m 'message'__

Чтобы сохранить изменения в репозитории, мы вызовем команду _git commit_ с дополнительным параметром _-m_, который позволит нам также добавить комментарий к нашему коммиту, чтобы было понятно, что изменилось.

    git commit -m 'text'

Если мы не добавим комментарий с помощью параметра, гит откроет текстовый редактор и всё равно заставит нас оставить коммент)

__Комментарий__: не забываем вызывать _git add_ перед коммитами!

$~$

Если мы не хотим каждый раз вызывать _git add_ для указания на файл, который мы хотим коммитить, можно передать дополнительный параметр _-a_:

    git commit -a

Однако так в коммите не будет комментария, и все равно откроется текстовый редактор для указания изменений. Чтобы это избежать в данном случае, можно сразу передать и параметр _-m_:

    git commit -am "text"

$~$

### __git log__

Чтобы посмотреть историю версий и комментарии к коммитам используем команду 

    git log

Это позволит нам увидеть не только комментарии, но и дату и время коммита, а также его "серийный номер" - он нам пригодится, если мы захотим откатиться к какой-то более ранней версии кода.

Если же мы хотим увидеть компактное отображение лога - нужно дополнительно передать параметр *--oneline*:

    git log --oneline

*Комментарий*: когда мы перемещаемся между версиями, при вызове _git log_ мы увидим логи только до той версии, на которую переключились. Чтобы увидеть их все - нужно передать дополнительный параметр __--all__:

    git log --oneline --all

$~$

### __git checkout 'version'__ - перемещаемся между версиями

Чтобы откатиться к какой-то конкретной версии - используем команду 

    git checkout

При этом необходимо указать конкретный "серийный номер" коммита, к которому мы хотим вернуться. Хорошая новость: его не нужно указывать полностью, достаточно, первых четырех символов.

$~$

### __git checkout master__ - возвращаемся в текущую версию

Чтобы вернуться в последнюю версию (последний коммит) - используем 

    git checkout master

$~$

### **git rm 'name'** - удаляем файл из git

Если мы какое-то время работали с файлом, но после его переименовали - __git__ посчитает, что мы его удалили, а в папке появился некий новый файл с незнакомым названием.


Как добавлять новые файлы мы знаем. Чтобы удалить старый - нужно воспользоваться командой 

    git rm filename


И вот теперь __git__ видит, что мы всего лишь переименовали файл.

Осталось лишь закоммитить изменения

### Ветки в git - git branch

git позволяет настроить систему, при которой один и тот же файл в разных вариациях может храниться одновременно - __но в разных ветках__.

Для этого используется команда __git branch__

Если просто ввести

    git branch
    
На выходе мы получим название текущей ветки, на которой мы находимся.


### Слияние веток - git merge

Если мы хотим слить несколько веток (несколько версий файлов) в одну - нам поможет команда __git merge__

При этом вызывать её нужно из той ветки, __в которую мы хотим перенести информацию__, дополнительно указывая название ветки, откуда мы эту информацию берем:

    git merge branch_name

При этом иногда всё проходит отлично, а иногда - возникают конфликты, например, когда на одном и том же месте в файле в разных ветках содержатся разные строки.

Когда они возникают - надо решить, что делать: оставлять левую часть, правую, или обе.

### Визуализация веток

Для визуализации веток в терминале в команду __git log__ передают параметр __graph__:

    git log --graph

$~$

## Работа с удаленными репозиториями в git

$~$

Кроме работы с системой контроля версий локально (с помощью непосредственно __git__), существуют способы работы с удаленными репозиториями. Мы будем использовать популярное решение - портал __GitHub__

Чтобы начать локальную работу с существующим на GitHub репозитории, нам понадобится команда __git clone__ с адресом репозитория:

    git clone https://some_url


Наш репозиторий загрузился в виде папки в текущий репозиторий. Чтобы начать работу конкретно с ним, будет нужно переместиться в него - с помощью команды __cd__ - change directory.

### Сохранение изменений в удаленном репозитории - git remote, git push

Чтобы отправить (__запушить__) наш существующий репозиторий в первый раз, нужна цепочка следующих команд:

    git remote add origin https://url
    git branch -M main
    git push -u origin main

В дальнейшем для пуша всё что понадобится - это последние 2 строки:

    git branch -M main
    git push -u origin main